(()=>{"use strict";const e=(e,t)=>`${e}=${encodeURIComponent(t)}`,t=e=>e.toISOString().replace(/-|:|\.\d+/g,""),n=(n,r={isAllday:!0,start:new Date})=>{if(r.isAllday){const a=t(r.start).replace(/T.*$/,"");return e(n,`${a}/${a}`)}const a=t(r.start),o=t(r.end);return e(n,`${a}/${o}`)},r=(e,t)=>({hour:e.hour+t.hour,minute:e.minute+t.minute}),a=(e,t)=>new Date(e.setHours(t.hour,t.minute)),o=e=>{const t=(e=>{const t=(e=>e.replace(/[０-９]/g,(e=>String.fromCharCode(e.charCodeAt(0)-65248))))(e).replace(/\s/g,"");return Array.from(t.matchAll(/(?:(?<year>\d{1,4}[\/年])?\s*(?<date>\d{1,2}(?:[\/-]\d{1,2}|\s?[\/月]\s?\d{1,2}日?)))/g)).map((e=>{const t=e.groups?.year?(e=>e<100?e+100*Math.floor((new Date).getFullYear()/100):e)(parseInt(e.groups.year.replace(/[\/年]/g,""))):(new Date).getFullYear(),n=e.groups?.date.replace(/\s|月/g,"/").replace(/[\/年]/g,"-").replace(/日/g,"");return new Date(`${t}-${n}`)})).filter((e=>!(e=>Number.isNaN(e.getTime()))(e)))})(e),n=(e=>Array.from(e.matchAll(/(?<hour>\d{1,2})[:：時](?<minute>\d{2})?(?!間)/g)).map((e=>({hour:parseInt(e.groups?.hour??"0"),minute:parseInt(e.groups?.minute??"0")}))))(e);if(0===t.length)return{isAllday:!0,start:new Date};if(0===n.length)return{isAllday:!0,start:t[0]};const o=a(t[0],n[0]),s=t.length>1&&t[1].getTime()>t[0].getTime()?t[1]:t[0],i=(e=>{const t=e.match(/(?<hour>\d{1,2})時間(?<minute>(半|\d{1,2}分))?/);if(t&&t.groups?.hour)return{hour:parseInt(t.groups.hour),minute:"半"===t.groups?.minute?30:parseInt(t.groups?.minute??"0")}})(e),l=i?r(n[0],i):n.length>1?n[1]:r(n[0],{hour:1,minute:0});return{isAllday:!1,start:o,end:a(s,l)}},s=e=>{const{text:t,details:n}=(e=>{const t=e.split("\n");return{text:t[0],details:t.slice(1).join("\n")}})(e),r=o(e),a=(e=>{const t=[/https:\/\/(?:[a-zA-Z0-9-]+\.)?zoom\.us\/j\/[a-zA-Z0-9]+(?:\?pwd=[a-zA-Z0-9]+)?/,/https:\/\/meet\.google\.com\/[a-zA-Z0-9]{3}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{3}(?:\?[-a-zA-Z0-9=&]+)?/];for(const n of t){const t=e.match(n);if(t)return t[0]}})(e);return{text:t,details:n,dates:r,location:a}},i=e=>{const t=`${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()}`,n=e.getMinutes().toString().padStart(2,"0");return`${t} ${e.getHours()}:${n}`};let l,u=s("");document?.getElementById("eventDetails")?.addEventListener("paste",(async()=>{const e=document.getElementById("useHtml")?.checked??!1;l=e?await(async()=>{try{const e=await navigator.clipboard.read();for(const t of e)if(t.types.includes("text/html")){const e=await t.getType("text/html");return await e.text()}return}catch(e){return void console.error(e)}})():void 0,l=l?(e=>{const t=(new DOMParser).parseFromString(e,"text/html");return t.querySelectorAll("[style]").forEach((e=>{e.removeAttribute("style")})),t.documentElement.innerHTML})(l):void 0;const t=document.getElementById("eventDetails"),n=new Event("input",{bubbles:!0});t.dispatchEvent(n)})),document?.getElementById("eventDetails")?.addEventListener("input",(()=>{let e;return(...t)=>{clearTimeout(e),e=setTimeout((()=>(()=>{const e=document.getElementById("eventDetails")?.value,t=l?e.split("\n")[0]+"\n"+l:e;u=s(t),(e=>{if(document.getElementById("previewTitle").innerText=e.text,document.getElementById("previewDescription").innerHTML=(e=>{const t=(new DOMParser).parseFromString(e,"text/html");return t.querySelectorAll("script").forEach((e=>{e.remove()})),t.documentElement.innerHTML})(e.details),document.getElementById("previewLocation").innerText=e.location??"",!e.dates)return;const t=e.dates.isAllday?e.dates.start.toLocaleDateString():i(e.dates.start)+" - "+i(e.dates.end);document.getElementById("previewDate").innerText=t})(u)})(...t)),200)}})()),document?.getElementById("generateLink")?.addEventListener("click",(()=>{const t=`https://calendar.google.com/calendar/render?action=TEMPLATE&${[e("text",(r=u).text),e("details",r.details),n("dates",r.dates),r.location?e("location",r.location):void 0].filter((e=>void 0!==e)).join("&")}`;var r;window.open(t,"_blank")}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFHUHJCLEVBQUlPLGdCQUFnQkMsU0FBUyxFRUZ1QmMsQ0FDekQ1QyxFQUFZdEIsU0FFZHVCLFNBQVNDLGVBQWUsbUJBQW9Cd0MsVUFBWTFDLEVBQVlYLFVBQVksSUFFM0VXLEVBQVloQixNQUNmLE9BSUYsTUFBTTZELEVBQVc3QyxFQUFZaEIsTUFBTXRELFNBQy9Cc0UsRUFBWWhCLE1BQU1yRCxNQUFNbUgscUJBQ3hCeEQsRUFBOEJVLEVBQVloQixNQUFNckQsT0FDaEQsTUFDQTJELEVBQThCVSxFQUFZaEIsTUFBTWxELEtBQ3BEbUUsU0FBU0MsZUFBZSxlQUFnQndDLFVBQVlHLENBQzlDLEVIT0pFLENBQVcvQyxFQUFZLEVFekJNZ0QsSUFBWVYsSUYwQnhDLElFMUJxRCxDQUN2RCxFRmdCRFcsSUFZRmhELFVBQVVDLGVBQWUsaUJBQWlCQyxpQkFBaUIsU0FBUyxLQUNsRSxNQUFNK0MsRUxnQkMsK0RBUFEsQ0FDYmxJLEVBQWdCLFFBRnVCbUksRUtSR25ELEdMVVp6RCxNQUM5QnZCLEVBQWdCLFVBQVdtSSxFQUFNekUsU0FDakNsRCxFQUFvQixRQUFTMkgsRUFBTW5FLE9BQ25DbUUsRUFBTTlELFNBQVdyRSxFQUFnQixXQUFZbUksRUFBTTlELGVBQVkrQixHQUMvRHpELFFBQVF5RixRQUFvQmhDLElBQVZnQyxJQUVldEUsS0FBSyxPQVJBLElBQUNxRSxFS056Q0UsT0FBT0MsS0FBS0osRUFBVSxTQUFTLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZXh0LXRvLWNhbGVuZGFyLWV2ZW50Ly4vc3JjL2xpYi9jbGlwYm9hcmQudHMiLCJ3ZWJwYWNrOi8vdGV4dC10by1jYWxlbmRhci1ldmVudC8uL3NyYy9ldmVudC9ldmVudC50cyIsIndlYnBhY2s6Ly90ZXh0LXRvLWNhbGVuZGFyLWV2ZW50Ly4vc3JjL2V2ZW50L3BhcnNlci9kYXRlcy50cyIsIndlYnBhY2s6Ly90ZXh0LXRvLWNhbGVuZGFyLWV2ZW50Ly4vc3JjL2V2ZW50L3BhcnNlci9tYWluLnRzIiwid2VicGFjazovL3RleHQtdG8tY2FsZW5kYXItZXZlbnQvLi9zcmMvZXZlbnQvcGFyc2VyL2xvY2F0aW9uLnRzIiwid2VicGFjazovL3RleHQtdG8tY2FsZW5kYXItZXZlbnQvLi9zcmMvbGliL2RhdGUudHMiLCJ3ZWJwYWNrOi8vdGV4dC10by1jYWxlbmRhci1ldmVudC8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly90ZXh0LXRvLWNhbGVuZGFyLWV2ZW50Ly4vc3JjL2xpYi9odG1sLnRzIiwid2VicGFjazovL3RleHQtdG8tY2FsZW5kYXItZXZlbnQvLi9zcmMvdXRpbHMvZGVib3VuY2UudHMiLCJ3ZWJwYWNrOi8vdGV4dC10by1jYWxlbmRhci1ldmVudC8uL3NyYy9saWIvcHJldmlldy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIOOCr+ODquODg+ODl+ODnOODvOODieOBq+OBguOCi2h0bWzjgpLlj5blvpfjgZnjgotcbiAqIOWPluW+l+OBp+OBjeOBquOBhOWgtOWQiOOBr3VuZGVmaW5lZOOCkui/lOOBmVxuICovXG5leHBvcnQgY29uc3QgZ2V0Q2xpcGJvYXJkSFRNTCA9IGFzeW5jICgpOiBQcm9taXNlPHN0cmluZyB8IHVuZGVmaW5lZD4gPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNsaXBib2FyZEl0ZW1zID0gYXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC5yZWFkKCk7XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgY2xpcGJvYXJkSXRlbXMpIHtcbiAgICAgIGlmIChpdGVtLnR5cGVzLmluY2x1ZGVzKCd0ZXh0L2h0bWwnKSkge1xuICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgaXRlbS5nZXRUeXBlKCd0ZXh0L2h0bWwnKTtcbiAgICAgICAgY29uc3QgaHRtbFRleHQgPSBhd2FpdCBibG9iLnRleHQoKTtcbiAgICAgICAgcmV0dXJuIGh0bWxUZXh0O1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn07XG4iLCJpbXBvcnQgeyBFVkVOVF9ST09UX1VSTCB9IGZyb20gJy4vY29uc3RhbnQnO1xuXG5leHBvcnQgdHlwZSBFdmVudERhdGVzID1cbiAgfCB7XG4gICAgICBpc0FsbGRheTogZmFsc2U7XG4gICAgICBzdGFydDogRGF0ZTtcbiAgICAgIGVuZDogRGF0ZTtcbiAgICB9XG4gIHwge1xuICAgICAgaXNBbGxkYXk6IHRydWU7XG4gICAgICBzdGFydDogRGF0ZTtcbiAgICB9O1xuXG5leHBvcnQgdHlwZSBHb29nbGVDYWxlbmRhckV2ZW50ID0ge1xuICB0ZXh0OiBzdHJpbmc7XG4gIGRldGFpbHM6IHN0cmluZztcbiAgZGF0ZXM/OiBFdmVudERhdGVzO1xuICBsb2NhdGlvbj86IHN0cmluZztcbn07XG5cbmNvbnN0IHBhcmFtVG9VUkxQYXJhbSA9IChrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIHJldHVybiBgJHtrZXl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKX1gO1xufTtcblxuY29uc3QgZGF0ZVRvUkZDNTU0NSA9IChkYXRlOiBEYXRlKTogc3RyaW5nID0+IHtcbiAgcmV0dXJuIGRhdGUudG9JU09TdHJpbmcoKS5yZXBsYWNlKC8tfDp8XFwuXFxkKy9nLCAnJyk7XG59O1xuXG5jb25zdCBkYXRlUGFyYW1Ub1VSTFBhcmFtID0gKFxuICBrZXk6IHN0cmluZyxcbiAgZXZlbnREYXRlczogRXZlbnREYXRlcyA9IHtcbiAgICBpc0FsbGRheTogdHJ1ZSxcbiAgICBzdGFydDogbmV3IERhdGUoKSxcbiAgfVxuKTogc3RyaW5nID0+IHtcbiAgaWYoZXZlbnREYXRlcy5pc0FsbGRheSl7XG4gICAgY29uc3QgdGltZSA9IGRhdGVUb1JGQzU1NDUoZXZlbnREYXRlcy5zdGFydCkucmVwbGFjZSgvVC4qJC8sICcnKTtcbiAgICByZXR1cm4gcGFyYW1Ub1VSTFBhcmFtKGtleSwgYCR7dGltZX0vJHt0aW1lfWApO1xuICB9XG5cbiAgY29uc3Qgc3RhcnQgPSBkYXRlVG9SRkM1NTQ1KGV2ZW50RGF0ZXMuc3RhcnQpO1xuICBjb25zdCBlbmQgPSBkYXRlVG9SRkM1NTQ1KGV2ZW50RGF0ZXMuZW5kKTtcbiAgcmV0dXJuIHBhcmFtVG9VUkxQYXJhbShrZXksIGAke3N0YXJ0fS8ke2VuZH1gKTtcbn07XG5cbmV4cG9ydCBjb25zdCBtYWtlR29vZ2xlQ2FsZW5kYXJFdmVudFVSTCA9IChldmVudDogR29vZ2xlQ2FsZW5kYXJFdmVudCk6IHN0cmluZyA9PiB7XG4gIGNvbnN0IHBhcmFtcyA9IFtcbiAgICBwYXJhbVRvVVJMUGFyYW0oJ3RleHQnLCBldmVudC50ZXh0KSxcbiAgICBwYXJhbVRvVVJMUGFyYW0oJ2RldGFpbHMnLCBldmVudC5kZXRhaWxzKSxcbiAgICBkYXRlUGFyYW1Ub1VSTFBhcmFtKCdkYXRlcycsIGV2ZW50LmRhdGVzKSxcbiAgICBldmVudC5sb2NhdGlvbiA/IHBhcmFtVG9VUkxQYXJhbSgnbG9jYXRpb24nLCBldmVudC5sb2NhdGlvbikgOiB1bmRlZmluZWQsXG4gIF0uZmlsdGVyKChwYXJhbSkgPT4gcGFyYW0gIT09IHVuZGVmaW5lZCk7XG5cbiAgcmV0dXJuIGAke0VWRU5UX1JPT1RfVVJMfSYke3BhcmFtcy5qb2luKCcmJyl9YDtcbn07XG4iLCJpbXBvcnQgeyBFdmVudERhdGVzIH0gZnJvbSAnLi4vZXZlbnQnO1xuXG5jb25zdCB6ZW5rYWt1RGlnaXRzVG9IYW5rYWt1ID0gKHRleHQ6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIHJldHVybiB0ZXh0LnJlcGxhY2UoL1vvvJAt77yZXS9nLCAocykgPT4ge1xuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHMuY2hhckNvZGVBdCgwKSAtIDB4ZmVlMCk7XG4gIH0pO1xufTtcblxuY29uc3Qgbm9ybWFsaXplWWVhciA9ICh5ZWFyOiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICBpZiAoeWVhciA8IDEwMCkge1xuICAgIGNvbnN0IGN1cnJlbnRDZW50dXJ5ID0gTWF0aC5mbG9vcihuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkgLyAxMDApICogMTAwO1xuICAgIHJldHVybiB5ZWFyICsgY3VycmVudENlbnR1cnk7XG4gIH1cbiAgcmV0dXJuIHllYXI7XG59O1xuXG5jb25zdCBpc0ludmFsaWREYXRlID0gKGRhdGU6IERhdGUpOiBib29sZWFuID0+IHtcbiAgcmV0dXJuIE51bWJlci5pc05hTihkYXRlLmdldFRpbWUoKSk7XG59O1xuXG5jb25zdCBmaW5kQWxsWWVhckFuZERheXMgPSAodGV4dDogc3RyaW5nKTogRGF0ZVtdID0+IHtcbiAgY29uc3Qgbm9ybWFsaXplZFRleHQgPSB6ZW5rYWt1RGlnaXRzVG9IYW5rYWt1KHRleHQpLnJlcGxhY2UoL1xccy9nLCAnJyk7XG4gIGNvbnN0IGRhdGVSZWdleCA9XG4gICAgLyg/Oig/PHllYXI+XFxkezEsNH1bXFwv5bm0XSk/XFxzKig/PGRhdGU+XFxkezEsMn0oPzpbXFwvLV1cXGR7MSwyfXxcXHM/W1xcL+aciF1cXHM/XFxkezEsMn3ml6U/KSkpL2c7XG4gIGNvbnN0IG1hdGNoZXMgPSBBcnJheS5mcm9tKG5vcm1hbGl6ZWRUZXh0Lm1hdGNoQWxsKGRhdGVSZWdleCkpO1xuXG4gIGNvbnN0IGRhdGVzID0gbWF0Y2hlcy5tYXAoKG1hdGNoKSA9PiB7XG4gICAgY29uc3QgeWVhciA9IG1hdGNoLmdyb3Vwcz8ueWVhclxuICAgICAgPyBub3JtYWxpemVZZWFyKHBhcnNlSW50KG1hdGNoLmdyb3Vwcy55ZWFyLnJlcGxhY2UoL1tcXC/lubRdL2csICcnKSkpXG4gICAgICA6IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTtcbiAgICBjb25zdCBkYXRlID0gbWF0Y2guZ3JvdXBzPy5kYXRlXG4gICAgICAucmVwbGFjZSgvXFxzfOaciC9nLCAnLycpXG4gICAgICAucmVwbGFjZSgvW1xcL+W5tF0vZywgJy0nKVxuICAgICAgLnJlcGxhY2UoL+aXpS9nLCAnJyk7XG4gICAgcmV0dXJuIG5ldyBEYXRlKGAke3llYXJ9LSR7ZGF0ZX1gKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGRhdGVzLmZpbHRlcigoZGF0ZSkgPT4gIWlzSW52YWxpZERhdGUoZGF0ZSkpO1xufTtcblxudHlwZSBUaW1lID0ge1xuICBob3VyOiBudW1iZXI7XG4gIG1pbnV0ZTogbnVtYmVyO1xufTtcblxuY29uc3QgZmluZEFsbFRpbWVzID0gKHRleHQ6IHN0cmluZyk6IFRpbWVbXSA9PiB7XG4gIGNvbnN0IHRpbWVSZWdleCA9IC8oPzxob3VyPlxcZHsxLDJ9KVs677ya5pmCXSg/PG1pbnV0ZT5cXGR7Mn0pPyg/IemWkykvZztcbiAgY29uc3QgbWF0Y2hlcyA9IEFycmF5LmZyb20odGV4dC5tYXRjaEFsbCh0aW1lUmVnZXgpKTtcblxuICBjb25zdCB0aW1lcyA9IG1hdGNoZXMubWFwKChtYXRjaCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBob3VyOiBwYXJzZUludChtYXRjaC5ncm91cHM/LmhvdXIgPz8gJzAnKSxcbiAgICAgIG1pbnV0ZTogcGFyc2VJbnQobWF0Y2guZ3JvdXBzPy5taW51dGUgPz8gJzAnKSxcbiAgICB9O1xuICB9KTtcblxuICByZXR1cm4gdGltZXM7XG59O1xuXG5jb25zdCBmaW5kVGltZVJhbmdlID0gKHRleHQ6IHN0cmluZyk6IFRpbWUgfCB1bmRlZmluZWQgPT4ge1xuICBjb25zdCB0aW1lUmVnZXggPSAvKD88aG91cj5cXGR7MSwyfSnmmYLplpMoPzxtaW51dGU+KOWNinxcXGR7MSwyfeWIhikpPy87XG4gIGNvbnN0IG1hdGNoID0gdGV4dC5tYXRjaCh0aW1lUmVnZXgpO1xuXG4gIGlmICghbWF0Y2ggfHwgIW1hdGNoLmdyb3Vwcz8uaG91cikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGhvdXIgPSBwYXJzZUludChtYXRjaC5ncm91cHMuaG91cik7XG4gIGNvbnN0IG1pbnV0ZSA9XG4gICAgbWF0Y2guZ3JvdXBzPy5taW51dGUgPT09ICfljYonID8gMzAgOiBwYXJzZUludChtYXRjaC5ncm91cHM/Lm1pbnV0ZSA/PyAnMCcpO1xuICByZXR1cm4geyBob3VyLCBtaW51dGUgfTtcbn07XG5cbmNvbnN0IGFkZFRpbWUgPSAoeDogVGltZSwgeTogVGltZSk6IFRpbWUgPT4ge1xuICByZXR1cm4ge1xuICAgIGhvdXI6IHguaG91ciArIHkuaG91cixcbiAgICBtaW51dGU6IHgubWludXRlICsgeS5taW51dGUsXG4gIH07XG59O1xuXG5jb25zdCBzZXRUaW1lVG9EYXRlID0gKGRhdGU6IERhdGUsIHRpbWU6IFRpbWUpOiBEYXRlID0+IHtcbiAgcmV0dXJuIG5ldyBEYXRlKGRhdGUuc2V0SG91cnModGltZS5ob3VyLCB0aW1lLm1pbnV0ZSkpO1xufTtcblxuZXhwb3J0IGNvbnN0IGV4dHJhY3RTdGFydEFuZEVuZERhdGVzID0gKHRleHQ6IHN0cmluZyk6IEV2ZW50RGF0ZXMgPT4ge1xuICBjb25zdCB5ZWFyQW5kRGF5cyA9IGZpbmRBbGxZZWFyQW5kRGF5cyh0ZXh0KTtcbiAgY29uc3QgdGltZXMgPSBmaW5kQWxsVGltZXModGV4dCk7XG5cbiAgaWYgKHllYXJBbmREYXlzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiB7XG4gICAgICBpc0FsbGRheTogdHJ1ZSxcbiAgICAgIHN0YXJ0OiBuZXcgRGF0ZSgpLFxuICAgIH07XG4gIH1cblxuICBpZiAodGltZXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzQWxsZGF5OiB0cnVlLFxuICAgICAgc3RhcnQ6IHllYXJBbmREYXlzWzBdLFxuICAgIH07XG4gIH1cblxuICAvLyBzdGFydOOBruaXpeS7mOOBq+aZguWIu+OCkuioreWumlxuICBjb25zdCBzdGFydCA9IHNldFRpbWVUb0RhdGUoeWVhckFuZERheXNbMF0sIHRpbWVzWzBdKTtcblxuICAvLyBlbmTjga7ml6Xku5jjgpLmjIflrprjgILmmYLliLvjgYzopIfmlbDjgYLjgovloLTlkIjjga/vvJLjgaTnm67jgpLjgIHjgarjgYTloLTlkIjjga/vvJHjgaTnm67vvIhzdGFydOOBqOWQjOOBmO+8ieOCkuS9v+OBhuOAglxuICAvLyDjgZ/jgaDjgZfjgIHvvJLjgaTnm67jga7ml6Xku5jjgYzvvJHjgaTnm67jgojjgorliY3jga7loLTlkIjjga/vvJHjgaTnm67jgpLkvb/jgYbjgIJcbiAgY29uc3QgZW5kVGFyZ2V0RGF0ZSA9XG4gICAgeWVhckFuZERheXMubGVuZ3RoID4gMSAmJiB5ZWFyQW5kRGF5c1sxXS5nZXRUaW1lKCkgPiB5ZWFyQW5kRGF5c1swXS5nZXRUaW1lKClcbiAgICAgID8geWVhckFuZERheXNbMV1cbiAgICAgIDogeWVhckFuZERheXNbMF07XG5cbiAgLy8g5omA6KaB5pmC6ZaT44GM5oyH5a6a44GV44KM44Gm44GE44KL5aC05ZCI44Gv44CBc3RhcnTjga7mmYLliLvjgavmiYDopoHmmYLplpPjgpLliqDnrpfjgZfjgaZlbmTjga7mmYLliLvjgpLoqK3lrppcbiAgLy8g5oyH5a6a44GV44KM44Gm44GE44Gq44GE5aC05ZCI44Gv44CB77yS44Gk55uu44Gu5pmC5Yi744G+44Gf44Gvc3RhcnTjga7mmYLliLvjgavvvJHmmYLplpPjgpLliqDnrpfjgZfjgaZlbmTjga7mmYLliLvjgpLoqK3lrppcbiAgY29uc3QgdGltZVJhbmdlID0gZmluZFRpbWVSYW5nZSh0ZXh0KTtcbiAgY29uc3QgZW5kVGFyZ2V0VGltZSA9IHRpbWVSYW5nZVxuICAgID8gYWRkVGltZSh0aW1lc1swXSwgdGltZVJhbmdlKVxuICAgIDogdGltZXMubGVuZ3RoID4gMVxuICAgID8gdGltZXNbMV1cbiAgICA6IGFkZFRpbWUodGltZXNbMF0sIHsgaG91cjogMSwgbWludXRlOiAwIH0pO1xuICBjb25zdCBlbmQgPSBzZXRUaW1lVG9EYXRlKGVuZFRhcmdldERhdGUsIGVuZFRhcmdldFRpbWUpO1xuXG4gIHJldHVybiB7XG4gICAgaXNBbGxkYXk6IGZhbHNlLFxuICAgIHN0YXJ0LFxuICAgIGVuZCxcbiAgfTtcbn07XG4iLCJpbXBvcnQgeyBFdmVudERhdGVzLCBHb29nbGVDYWxlbmRhckV2ZW50LCBtYWtlR29vZ2xlQ2FsZW5kYXJFdmVudFVSTCB9IGZyb20gJy4uL2V2ZW50JztcbmltcG9ydCB7IGV4dHJhY3RTdGFydEFuZEVuZERhdGVzIH0gZnJvbSAnLi9kYXRlcyc7XG5pbXBvcnQgeyBleHRyYWN0TWVldGluZ1VSTCB9IGZyb20gJy4vbG9jYXRpb24nO1xuXG4vKipcbiAqIHRleHTjgYvjgonjgqTjg5njg7Pjg4jjgr/jgqTjg4jjg6vjgpLmir3lh7rjgZnjgovjgIJcbiAqIOacgOWIneOBruihjOOCkuOCpOODmeODs+ODiOOCv+OCpOODiOODq+OBqOOBl+OBpuaJseOBhuOAglxuICovXG5jb25zdCBleHRyYWN0RXZlbnRUaXRsZUFuZERldGFpbHMgPSAoXG4gIHRleHQ6IHN0cmluZ1xuKTogUGljazxHb29nbGVDYWxlbmRhckV2ZW50LCAndGV4dCcgfCAnZGV0YWlscyc+ID0+IHtcbiAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KCdcXG4nKTtcblxuICByZXR1cm4ge1xuICAgIHRleHQ6IGxpbmVzWzBdLFxuICAgIGRldGFpbHM6IGxpbmVzLnNsaWNlKDEpLmpvaW4oJ1xcbicpLFxuICB9O1xufTtcblxuZXhwb3J0IGNvbnN0IG1ha2VHb29nbGVDYWxlbmRhckV2ZW50UGFyYW1zID0gKHBsYWluVGV4dDogc3RyaW5nKTogR29vZ2xlQ2FsZW5kYXJFdmVudCA9PiB7XG4gIGNvbnN0IHsgdGV4dCwgZGV0YWlscyB9ID0gZXh0cmFjdEV2ZW50VGl0bGVBbmREZXRhaWxzKHBsYWluVGV4dCk7XG4gIGNvbnN0IGRhdGVzOiBFdmVudERhdGVzID0gZXh0cmFjdFN0YXJ0QW5kRW5kRGF0ZXMocGxhaW5UZXh0KTtcbiAgY29uc3QgbWVldGluZ1VSTCA9IGV4dHJhY3RNZWV0aW5nVVJMKHBsYWluVGV4dCk7XG5cbiAgcmV0dXJuIHtcbiAgICB0ZXh0LFxuICAgIGRldGFpbHMsXG4gICAgZGF0ZXMsXG4gICAgbG9jYXRpb246IG1lZXRpbmdVUkwsXG4gIH07XG59OyIsImV4cG9ydCBjb25zdCBleHRyYWN0TWVldGluZ1VSTCA9ICh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQgPT4ge1xuICBjb25zdCB1cmxSZWdleCA9IFtcbiAgICAvaHR0cHM6XFwvXFwvKD86W2EtekEtWjAtOS1dK1xcLik/em9vbVxcLnVzXFwvalxcL1thLXpBLVowLTldKyg/OlxcP3B3ZD1bYS16QS1aMC05XSspPy8sIC8vIFpvb21cbiAgICAvaHR0cHM6XFwvXFwvbWVldFxcLmdvb2dsZVxcLmNvbVxcL1thLXpBLVowLTldezN9LVthLXpBLVowLTldezR9LVthLXpBLVowLTldezN9KD86XFw/Wy1hLXpBLVowLTk9Jl0rKT8vLCAvLyBHb29nbGUgTWVldFxuICBdO1xuXG4gIGZvciAoY29uc3QgcmVnZXggb2YgdXJsUmVnZXgpIHtcbiAgICBjb25zdCBtYXRjaCA9IHRleHQubWF0Y2gocmVnZXgpO1xuICAgIGlmIChtYXRjaCkge1xuICAgICAgcmV0dXJuIG1hdGNoWzBdO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB1bmRlZmluZWQ7XG59O1xuIiwiZXhwb3J0IGNvbnN0IGZvcm1hdERhdGVUb0RhdGVBbmRUaW1lID0gKGRhdGU6IERhdGUpOiBzdHJpbmcgPT4ge1xuICBjb25zdCBkYXRlU3RyID0gYCR7ZGF0ZS5nZXRGdWxsWWVhcigpfS8ke2RhdGUuZ2V0TW9udGgoKSArIDF9LyR7ZGF0ZS5nZXREYXRlKCl9YDtcbiAgY29uc3QgbWludXRlU3RyID0gZGF0ZS5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpO1xuICBjb25zdCB0aW1lU3RyID0gYCR7ZGF0ZS5nZXRIb3VycygpfToke21pbnV0ZVN0cn1gO1xuICByZXR1cm4gYCR7ZGF0ZVN0cn0gJHt0aW1lU3RyfWA7XG59O1xuIiwiaW1wb3J0IHsgZ2V0Q2xpcGJvYXJkSFRNTCB9IGZyb20gJy4vbGliL2NsaXBib2FyZCc7XG5pbXBvcnQgeyBtYWtlR29vZ2xlQ2FsZW5kYXJFdmVudFVSTCB9IGZyb20gJy4vZXZlbnQvZXZlbnQnO1xuaW1wb3J0IHsgbWFrZUdvb2dsZUNhbGVuZGFyRXZlbnRQYXJhbXMgfSBmcm9tICcuL2V2ZW50L3BhcnNlci9tYWluJztcbmltcG9ydCB7IHNldFByZXZpZXcgfSBmcm9tICcuL2xpYi9wcmV2aWV3JztcbmltcG9ydCB7IHJlbW92ZUFsbFN0eWxlQXR0cmlidXRlcyB9IGZyb20gJy4vbGliL2h0bWwnO1xuaW1wb3J0IHsgZGVib3VuY2UgfSBmcm9tICcuL3V0aWxzL2RlYm91bmNlJztcblxubGV0IGV2ZW50UGFyYW1zID0gbWFrZUdvb2dsZUNhbGVuZGFyRXZlbnRQYXJhbXMoJycpO1xubGV0IGNsaXBib2FyZEh0bWw6IHN0cmluZyB8IHVuZGVmaW5lZDtcblxuZG9jdW1lbnQ/LmdldEVsZW1lbnRCeUlkKCdldmVudERldGFpbHMnKT8uYWRkRXZlbnRMaXN0ZW5lcigncGFzdGUnLCBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IHVzZUh0bWwgPVxuICAgIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlSHRtbCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQpPy5jaGVja2VkID8/IGZhbHNlO1xuICBjbGlwYm9hcmRIdG1sID0gdXNlSHRtbCA/IGF3YWl0IGdldENsaXBib2FyZEhUTUwoKSA6IHVuZGVmaW5lZDtcbiAgY2xpcGJvYXJkSHRtbCA9IGNsaXBib2FyZEh0bWwgPyByZW1vdmVBbGxTdHlsZUF0dHJpYnV0ZXMoY2xpcGJvYXJkSHRtbCkgOiB1bmRlZmluZWQ7XG5cbiAgLy8gUGFzdGXjgqTjg5njg7Pjg4jjga7lh6bnkIbjgYzntYLjgo/jgaPjgZ/jgonjgIHmiYvli5XjgadpbnB1dOOCpOODmeODs+ODiOOCkuODiOODquOCrOODvOOBmeOCi1xuICBjb25zdCBldmVudERldGFpbHNFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V2ZW50RGV0YWlscycpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG4gIGNvbnN0IGlucHV0RXZlbnQgPSBuZXcgRXZlbnQoJ2lucHV0JywgeyBidWJibGVzOiB0cnVlIH0pO1xuICBldmVudERldGFpbHNFbGVtZW50LmRpc3BhdGNoRXZlbnQoaW5wdXRFdmVudCk7XG59KTtcblxuZG9jdW1lbnQ/LmdldEVsZW1lbnRCeUlkKCdldmVudERldGFpbHMnKT8uYWRkRXZlbnRMaXN0ZW5lcihcbiAgJ2lucHV0JyxcbiAgZGVib3VuY2UoKCkgPT4ge1xuICAgIGNvbnN0IGlucHV0VGV4dCA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXZlbnREZXRhaWxzJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudClcbiAgICAgID8udmFsdWU7XG5cbiAgICBjb25zdCB0ZXh0ID0gY2xpcGJvYXJkSHRtbFxuICAgICAgPyBpbnB1dFRleHQuc3BsaXQoJ1xcbicpWzBdICsgJ1xcbicgKyBjbGlwYm9hcmRIdG1sXG4gICAgICA6IGlucHV0VGV4dDtcbiAgICBldmVudFBhcmFtcyA9IG1ha2VHb29nbGVDYWxlbmRhckV2ZW50UGFyYW1zKHRleHQpO1xuICAgIHNldFByZXZpZXcoZXZlbnRQYXJhbXMpO1xuICB9LCAyMDApXG4pO1xuXG5kb2N1bWVudD8uZ2V0RWxlbWVudEJ5SWQoJ2dlbmVyYXRlTGluaycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgY29uc3QgZXZlbnRVcmwgPSBtYWtlR29vZ2xlQ2FsZW5kYXJFdmVudFVSTChldmVudFBhcmFtcyk7XG5cbiAgd2luZG93Lm9wZW4oZXZlbnRVcmwsICdfYmxhbmsnKTtcbn0pO1xuIiwiLyoqXG4gKiBodG1s44OG44Kt44K544OI5YaF44GL44KJc2NyaXB044K/44Kw44KS5YWo44Gm5YmK6Zmk44GZ44KLXG4gKi9cbmV4cG9ydCBjb25zdCByZW1vdmVBbGxTY3JpcHRUYWdzID0gKGh0bWw6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcbiAgY29uc3QgZG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhodG1sLCAndGV4dC9odG1sJyk7XG5cbiAgZG9jLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NjcmlwdCcpLmZvckVhY2goKGVsZSkgPT4ge1xuICAgIGVsZS5yZW1vdmUoKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGRvYy5kb2N1bWVudEVsZW1lbnQuaW5uZXJIVE1MO1xufTtcblxuLyoqXG4gKiBodG1s44OG44Kt44K544OI5YaF44GL44KJc3R5bGXlsZ7mgKfjgpLlhajjgabliYrpmaTjgZnjgotcbiAqL1xuZXhwb3J0IGNvbnN0IHJlbW92ZUFsbFN0eWxlQXR0cmlidXRlcyA9IChodG1sOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICBjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7XG4gIGNvbnN0IGRvYyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoaHRtbCwgJ3RleHQvaHRtbCcpO1xuXG4gIGRvYy5xdWVyeVNlbGVjdG9yQWxsKCdbc3R5bGVdJykuZm9yRWFjaCgoZWxlKSA9PiB7XG4gICAgZWxlLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGRvYy5kb2N1bWVudEVsZW1lbnQuaW5uZXJIVE1MO1xufTtcbiIsImV4cG9ydCBjb25zdCBkZWJvdW5jZSA9IDxUIGV4dGVuZHMgKC4uLmFyZ3M6IGFueVtdKSA9PiB1bmtub3duPihcbiAgY2FsbGJhY2s6IFQsXG4gIGRlbGF5OiBudW1iZXJcbik6ICgoLi4uYXJnczogUGFyYW1ldGVyczxUPikgPT4gdm9pZCkgPT4ge1xuICBsZXQgdGltZW91dElkOiBOb2RlSlMuVGltZW91dDtcbiAgcmV0dXJuICguLi5hcmdzKSA9PiB7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjYWxsYmFjayguLi5hcmdzKSwgZGVsYXkpO1xuICB9O1xufTtcbiIsImltcG9ydCB7IEdvb2dsZUNhbGVuZGFyRXZlbnQgfSBmcm9tICcuLi9ldmVudC9ldmVudCc7XG5pbXBvcnQgeyBmb3JtYXREYXRlVG9EYXRlQW5kVGltZSBhcyBmb3JtYXREYXRlVG9EYXRlQW5kVGltZVN0cmluZyB9IGZyb20gJy4vZGF0ZSc7XG5pbXBvcnQgeyByZW1vdmVBbGxTY3JpcHRUYWdzIH0gZnJvbSAnLi9odG1sJztcblxuLyoqXG4gKiDlhaXlipvmg4XloLHjgpLjg5fjg6zjg5Pjg6Xjg7zjgavlj43mmKDjgZnjgotcbiAqL1xuZXhwb3J0IGNvbnN0IHNldFByZXZpZXcgPSAoZXZlbnRQYXJhbXM6IEdvb2dsZUNhbGVuZGFyRXZlbnQpOiB2b2lkID0+IHtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXZpZXdUaXRsZScpIS5pbm5lclRleHQgPSBldmVudFBhcmFtcy50ZXh0O1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJldmlld0Rlc2NyaXB0aW9uJykhLmlubmVySFRNTCA9IHJlbW92ZUFsbFNjcmlwdFRhZ3MoXG4gICAgZXZlbnRQYXJhbXMuZGV0YWlsc1xuICApO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJldmlld0xvY2F0aW9uJykhLmlubmVyVGV4dCA9IGV2ZW50UGFyYW1zLmxvY2F0aW9uID8/ICcnO1xuXG4gIGlmICghZXZlbnRQYXJhbXMuZGF0ZXMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyDntYLml6Xjga7loLTlkIjjga/ml6Xku5jjga7jgb/jgIHjgZ3jgozku6XlpJbjga/plovlp4vml6XmmYLjgajntYLkuobml6XmmYLjgpLooajnpLpcbiAgY29uc3QgZGF0ZVRleHQgPSBldmVudFBhcmFtcy5kYXRlcy5pc0FsbGRheVxuICAgID8gZXZlbnRQYXJhbXMuZGF0ZXMuc3RhcnQudG9Mb2NhbGVEYXRlU3RyaW5nKClcbiAgICA6IGZvcm1hdERhdGVUb0RhdGVBbmRUaW1lU3RyaW5nKGV2ZW50UGFyYW1zLmRhdGVzLnN0YXJ0KSArXG4gICAgICAnIC0gJyArXG4gICAgICBmb3JtYXREYXRlVG9EYXRlQW5kVGltZVN0cmluZyhldmVudFBhcmFtcy5kYXRlcy5lbmQpO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJldmlld0RhdGUnKSEuaW5uZXJUZXh0ID0gZGF0ZVRleHQ7XG4gIHJldHVybjtcbn07XG4iXSwibmFtZXMiOlsicGFyYW1Ub1VSTFBhcmFtIiwia2V5IiwidmFsdWUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJkYXRlVG9SRkM1NTQ1IiwiZGF0ZSIsInRvSVNPU3RyaW5nIiwicmVwbGFjZSIsImRhdGVQYXJhbVRvVVJMUGFyYW0iLCJldmVudERhdGVzIiwiaXNBbGxkYXkiLCJzdGFydCIsIkRhdGUiLCJ0aW1lIiwiZW5kIiwiYWRkVGltZSIsIngiLCJ5IiwiaG91ciIsIm1pbnV0ZSIsInNldFRpbWVUb0RhdGUiLCJzZXRIb3VycyIsImV4dHJhY3RTdGFydEFuZEVuZERhdGVzIiwidGV4dCIsInllYXJBbmREYXlzIiwibm9ybWFsaXplZFRleHQiLCJzIiwiU3RyaW5nIiwiZnJvbUNoYXJDb2RlIiwiY2hhckNvZGVBdCIsInplbmtha3VEaWdpdHNUb0hhbmtha3UiLCJBcnJheSIsImZyb20iLCJtYXRjaEFsbCIsIm1hcCIsIm1hdGNoIiwieWVhciIsImdyb3VwcyIsIk1hdGgiLCJmbG9vciIsImdldEZ1bGxZZWFyIiwibm9ybWFsaXplWWVhciIsInBhcnNlSW50IiwiZmlsdGVyIiwiTnVtYmVyIiwiaXNOYU4iLCJnZXRUaW1lIiwiaXNJbnZhbGlkRGF0ZSIsImZpbmRBbGxZZWFyQW5kRGF5cyIsInRpbWVzIiwiZmluZEFsbFRpbWVzIiwibGVuZ3RoIiwiZW5kVGFyZ2V0RGF0ZSIsInRpbWVSYW5nZSIsImZpbmRUaW1lUmFuZ2UiLCJlbmRUYXJnZXRUaW1lIiwibWFrZUdvb2dsZUNhbGVuZGFyRXZlbnRQYXJhbXMiLCJwbGFpblRleHQiLCJkZXRhaWxzIiwibGluZXMiLCJzcGxpdCIsInNsaWNlIiwiam9pbiIsImV4dHJhY3RFdmVudFRpdGxlQW5kRGV0YWlscyIsImRhdGVzIiwibWVldGluZ1VSTCIsInVybFJlZ2V4IiwicmVnZXgiLCJleHRyYWN0TWVldGluZ1VSTCIsImxvY2F0aW9uIiwiZm9ybWF0RGF0ZVRvRGF0ZUFuZFRpbWUiLCJkYXRlU3RyIiwiZ2V0TW9udGgiLCJnZXREYXRlIiwibWludXRlU3RyIiwiZ2V0TWludXRlcyIsInRvU3RyaW5nIiwicGFkU3RhcnQiLCJnZXRIb3VycyIsImNsaXBib2FyZEh0bWwiLCJldmVudFBhcmFtcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJhZGRFdmVudExpc3RlbmVyIiwiYXN5bmMiLCJ1c2VIdG1sIiwiY2hlY2tlZCIsImNsaXBib2FyZEl0ZW1zIiwibmF2aWdhdG9yIiwiY2xpcGJvYXJkIiwicmVhZCIsIml0ZW0iLCJ0eXBlcyIsImluY2x1ZGVzIiwiYmxvYiIsImdldFR5cGUiLCJlIiwiY29uc29sZSIsImVycm9yIiwiZ2V0Q2xpcGJvYXJkSFRNTCIsInVuZGVmaW5lZCIsImh0bWwiLCJkb2MiLCJET01QYXJzZXIiLCJwYXJzZUZyb21TdHJpbmciLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImVsZSIsInJlbW92ZUF0dHJpYnV0ZSIsImRvY3VtZW50RWxlbWVudCIsImlubmVySFRNTCIsInJlbW92ZUFsbFN0eWxlQXR0cmlidXRlcyIsImV2ZW50RGV0YWlsc0VsZW1lbnQiLCJpbnB1dEV2ZW50IiwiRXZlbnQiLCJidWJibGVzIiwiZGlzcGF0Y2hFdmVudCIsInRpbWVvdXRJZCIsImFyZ3MiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiaW5wdXRUZXh0IiwiaW5uZXJUZXh0IiwicmVtb3ZlIiwicmVtb3ZlQWxsU2NyaXB0VGFncyIsImRhdGVUZXh0IiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwic2V0UHJldmlldyIsImNhbGxiYWNrIiwiZGVib3VuY2UiLCJldmVudFVybCIsImV2ZW50IiwicGFyYW0iLCJ3aW5kb3ciLCJvcGVuIl0sInNvdXJjZVJvb3QiOiIifQ==